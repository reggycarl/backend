{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Desktop/steaman-backend/src/components/CategoryWidgets/CategoryWidget.jsx\";\nimport React, { Component } from \"react\";\nimport { Card, CardTitle, CardBody, Row, Col, CardText, Form, FormGroup, Input, Label, FormText, Button } from \"reactstrap\";\nimport moment from \"moment\";\nimport axiosInstance, { baseurl } from \"../misc/Axios\";\nimport SubmitButton from \"../Controls/SubmitButton\";\nimport { Link } from \"react-router-dom\";\nimport { getIndirectCategoryWidgets, getCategoryWidgetsTypes, getGenders, getMaritalStatuses, getCategories } from \"../misc/functions\";\nimport { history } from \"../../index\";\nimport NumberField from \"../Controls/NumberField\";\nimport \"./category_widgets.scss\";\nimport Dropzone from \"react-dropzone\";\nimport CategoriesModal from \"../Modals/CategoriesModal\";\nimport Table from \"reactstrap/lib/Table\";\nexport default class CategoryWidget extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      showCategoriesModal: false,\n      category_widget: {\n        photo_id: null,\n        description: \"\",\n        link: \"\",\n        products_list: []\n      },\n      editing: false,\n      readOnly: this.props.match.params.id != \"\" && this.props.match.params.id != null,\n      category_widget_uuid: this.props.match.params.id,\n      existing_record: this.props.match.params.id != \"\" && this.props.match.params.id != null\n    };\n\n    this.onChange = e => {\n      console.log(e.target.name);\n      this.setState({ ...this.state,\n        category_widget: { ...this.state.category_widget,\n          [e.target.name]: e.target.value\n        }\n      });\n    };\n\n    this.onItemChange = (i, e) => {\n      console.log(\"THIS IS INDEX\", i);\n      console.log(\"THIS IS ELEMENT\", e);\n      var products_list = [...this.state.category_widget.products_list];\n      console.log(\"THESE ARE PRODUCTS\", products_list);\n      products_list[i].product = null;\n      products_list[i].temp_sku = e.target.value;\n    };\n\n    this.addProduct = e => {\n      var products_list = this.state.category_widget.products_list;\n      products_list.push({\n        temp_sku: \"\",\n        product: {}\n      });\n      this.setState({ ...this.state,\n        category_widget: { ...this.state.category_widget,\n          products_list: products_list\n        }\n      });\n    };\n\n    this.removeProduct = (i, e) => {\n      var products_list = this.state.category_widget.products_list;\n      products_list.splice(i, 1);\n      this.setState({ ...this.state,\n        category_widget: { ...this.state.category_widget,\n          products_list: products_list\n        }\n      });\n    };\n\n    this.handleChangeSelect = (selectedOption, val) => {\n      var state = { ...this.state,\n        category_widget: { ...this.state.category_widget,\n          [selectedOption]: val.value\n        },\n        [selectedOption]: val\n      };\n      this.setState({ ...state\n      });\n    };\n\n    this.onDateChanged = (momentdate, attr_name) => {\n      // console.log(\"ClassName is\", momentdate.constructor.name)\n      var new_date = new moment();\n\n      if (momentdate.constructor.name == new_date.constructor.name) {\n        var new_state = { ...this.state,\n          category_widget: { ...this.state.category_widget,\n            [attr_name]: momentdate\n          }\n        };\n        this.setState({ ...new_state\n        });\n      } else {\n        console.log(this.state.category_widget[attr_name]);\n        var date = new moment(this.state.category_widget[attr_name]);\n        var new_state = { ...this.state,\n          category_widget: { ...this.state.category_widget,\n            [attr_name]: date\n          }\n        };\n        this.setState({ ...new_state\n        });\n      }\n    };\n\n    this.setCategoryWidgets = (state, category_widget) => {\n      var new_state = { ...state,\n        category_widget: category_widget // category_id: state.categories.find(\n        //   (obj) => obj.value == category_widget.category_id\n        // ),\n\n      };\n      return new_state;\n    };\n\n    this.onValueChange = (e, val) => {\n      console.log(val);\n      this.setState({ ...this.state,\n        category_widget: { ...this.state.category_widget,\n          [e]: val.floatValue\n        }\n      });\n    };\n\n    this.handleChangeSelect = (selectedOption, val) => {\n      var state = { ...this.state,\n        category_widget: { ...this.state.category_widget,\n          [selectedOption]: val.value\n        },\n        [selectedOption]: val\n      };\n      this.setState({ ...state\n      });\n    };\n\n    this.onDrop = (name, acceptedFiles) => {\n      console.log(name);\n      console.log(acceptedFiles);\n\n      if (this.state.readOnly != true) {\n        acceptedFiles.map((file, i) => {\n          var formData = new FormData();\n          formData.append(\"file\", file);\n          axiosInstance.post(\"/photos\", formData).then(response => {\n            this.setState({ ...this.state,\n              category_widget: { ...this.state.category_widget,\n                photo_id: response.data.photo.id,\n                photo: response.data.photo\n              }\n            });\n          });\n        });\n      }\n    };\n\n    this.componentDidMount = () => {\n      var self = this; // Promise.all([getCategories()]).then(([categories]) => {\n\n      console.log(\"ID\", this.props.match.params.id);\n\n      if (self.state.existing_record == true) {\n        console.log(\"FECHING EXISTING RECORD\");\n        axiosInstance.get(`/admins/category_widgets/${this.state.category_widget_uuid}`).then(response => {\n          var new_state = { ...this.state,\n            existing_record: true,\n            readOnly: true // categories: categories,\n\n          };\n          new_state = self.setCategoryWidgets(new_state, response.data.category_widget);\n          self.setState({ ...new_state\n          });\n        });\n      } else {\n        self.setState({ ...this.state // categories: categories,\n\n        });\n      } // });\n\n    };\n\n    this.toggleCategoriesModal = () => {\n      this.setState({ ...this.state,\n        showCategoriesModal: !this.state.showCategoriesModal\n      });\n    };\n\n    this.onSubmit = e => {\n      e.preventDefault();\n      var self = this;\n      var product_ids = this.state.category_widget.products_list.map(item => {\n        if (item.product != null) {\n          return item.product.id;\n        }\n      });\n      console.log(\"PRODUCT_IDS\", product_ids);\n\n      if (self.state.readOnly == true && self.state.existing_record == true) {\n        self.setState({ ...self.state,\n          readOnly: false\n        });\n      } else {\n        var instance;\n\n        if (self.state.existing_record != true) {\n          instance = axiosInstance.post(\"/admins/category_widgets\", {\n            category_widget: { ...this.state.category_widget,\n              product_ids: product_ids\n            }\n          });\n        } else {\n          instance = axiosInstance.put(`/admins/category_widgets/${this.state.category_widget_id || this.state.category_widget.uuid}`, {\n            category_widget: { ...this.state.category_widget,\n              product_ids: product_ids\n            }\n          });\n        }\n\n        instance.then(response => {\n          console.log(\"RESPONSE\", response); // console.log(\"Setting state\")\n\n          if (this.state.existing_record == true) {\n            var new_state = this.setCategoryWidgets(this.state, response.data.category_widget);\n            console.log(\"THIS IS NEW STATE\", new_state);\n            this.setState({ ...new_state,\n              readOnly: true\n            });\n          } else {\n            this.props.history.push(`/appearances/category_widgets/${response.data.category_widget.uuid}`); // this.setState({ ...this.state, readOnly: true, existing_record: true, editing: false })\n          }\n        });\n      }\n    };\n\n    this.fetchProduct = (i, e) => {\n      console.log(\"THIS IS VALUE\", e.target.value);\n      var sku = e.target.value;\n      axiosInstance.get(`/admins/products/get_by_sku?sku=${sku}`).then(response => {\n        console.log(\"THIS IS RESPONSE\", response);\n\n        if (response.status == 200) {\n          var products_list = this.state.category_widget.products_list;\n          products_list[i].product = response.data.product;\n          this.setState({ ...this.state,\n            category_widget: { ...this.state.category_widget\n            }\n          });\n        }\n      });\n    };\n\n    this.selectCategory = category => {\n      this.setState({ ...this.state,\n        category_widget: { ...this.state.category_widget,\n          category_id: category.id,\n          category: category\n        }\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Col, {\n      md: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(CategoriesModal, {\n      isOpen: this.state.showCategoriesModal,\n      category_id: this.state.category_widget.category_id,\n      selectCategory: this.selectCategory.bind(this),\n      toggle: this.toggleCategoriesModal,\n      parentForm: this,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CardTitle, {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 13\n      }\n    }, \"CategoryWidget\", /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-success btn-sm\",\n      to: \"/appearances/category_widgets/new\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 19\n      }\n    }, \"New CategoryWidget\")))), /*#__PURE__*/React.createElement(CardText, {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Dropzone, {\n      disabled: this.state.readOnly,\n      onDrop: this.readOnly ? null : this.onDrop.bind(null, \"photo\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 25\n      }\n    }, ({\n      getRootProps,\n      getInputProps\n    }) => /*#__PURE__*/React.createElement(Col, Object.assign({\n      id: \"photoBox\"\n    }, getRootProps(), {\n      className: `${this.state.readOnly ? \"\" : \"dropZone\"}  col-md-12`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", Object.assign({}, getInputProps(), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 31\n      }\n    })), this.state.category_widget.photo ? /*#__PURE__*/React.createElement(\"img\", {\n      src: this.state.category_widget.photo.image_url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 33\n      }\n    }) : null)))), /*#__PURE__*/React.createElement(Col, {\n      md: 9,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"exampleEmail\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 25\n      }\n    }, \"Category\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      name: \"name\",\n      value: this.state.category_widget.category ? this.state.category_widget.category.name : \"\",\n      placeholder: \"Category Name\",\n      onChange: this.onChange,\n      readOnly: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"exampleEmail\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 25\n      }\n    }, \"\\xA0\"), /*#__PURE__*/React.createElement(Button, {\n      className: \"form-control\",\n      onClick: this.toggleCategoriesModal,\n      disabled: this.state.readOnly,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 25\n      }\n    }, \"Select\"))), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 27\n      }\n    }, \"Description\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"textarea\",\n      name: \"description\",\n      value: this.state.category_widget.description,\n      placeholder: \"Slider Description\",\n      onChange: this.onChange,\n      readOnly: this.state.readOnly,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      for: \"name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 27\n      }\n    }, \"Link\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      name: \"link\",\n      value: this.state.category_widget.link,\n      placeholder: \"Slider Link\",\n      onChange: this.onChange,\n      readOnly: this.state.readOnly,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 27\n      }\n    }))))), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Table, {\n      striped: \"true\",\n      bordered: \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      width: \"25%\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 31\n      }\n    }, \"Pruduct SKU\"), /*#__PURE__*/React.createElement(\"th\", {\n      width: \"70%\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 31\n      }\n    }, \"Pruduct Name\"), /*#__PURE__*/React.createElement(\"th\", {\n      width: \"5%\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 31\n      }\n    }))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 27\n      }\n    }, this.state.category_widget.products_list.map((item, i) => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 38\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(Input, {\n        value: item.product == null ? item.temp_sku : item.product.sku,\n        readOnly: this.state.readOnly,\n        onBlur: this.fetchProduct.bind(this, i),\n        onChange: this.onItemChange.bind(this, i),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 35\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(Input, {\n        value: item.product != null ? item.product.name : \"\",\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 33\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        color: \"danger\",\n        className: \"btn-sm\",\n        onClick: this.removeProduct,\n        disabled: this.state.readOnly,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 33\n        }\n      }, \" X \")));\n    })), /*#__PURE__*/React.createElement(\"tfoot\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"3\",\n      className: \"right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      color: \"success\",\n      className: \"btn-sm\",\n      onClick: this.addProduct,\n      disabled: this.state.readOnly,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 33\n      }\n    }, \" Add Product\"))))))), /*#__PURE__*/React.createElement(Col, {\n      md: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(SubmitButton, {\n      onClick: this.onSubmit,\n      readOnly: this.state.readOnly,\n      editing: this.state.editing,\n      existing_record: this.state.existing_record,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 19\n      }\n    })))))));\n  }\n\n}","map":{"version":3,"sources":["/Users/mac/Desktop/steaman-backend/src/components/CategoryWidgets/CategoryWidget.jsx"],"names":["React","Component","Card","CardTitle","CardBody","Row","Col","CardText","Form","FormGroup","Input","Label","FormText","Button","moment","axiosInstance","baseurl","SubmitButton","Link","getIndirectCategoryWidgets","getCategoryWidgetsTypes","getGenders","getMaritalStatuses","getCategories","history","NumberField","Dropzone","CategoriesModal","Table","CategoryWidget","state","showCategoriesModal","category_widget","photo_id","description","link","products_list","editing","readOnly","props","match","params","id","category_widget_uuid","existing_record","onChange","e","console","log","target","name","setState","value","onItemChange","i","product","temp_sku","addProduct","push","removeProduct","splice","handleChangeSelect","selectedOption","val","onDateChanged","momentdate","attr_name","new_date","constructor","new_state","date","setCategoryWidgets","onValueChange","floatValue","onDrop","acceptedFiles","map","file","formData","FormData","append","post","then","response","data","photo","componentDidMount","self","get","toggleCategoriesModal","onSubmit","preventDefault","product_ids","item","instance","put","category_widget_id","uuid","fetchProduct","sku","status","selectCategory","category","category_id","render","bind","getRootProps","getInputProps","image_url"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  Card,\n  CardTitle,\n  CardBody,\n  Row,\n  Col,\n  CardText,\n  Form,\n  FormGroup,\n  Input,\n  Label,\n  FormText,\n  Button,\n} from \"reactstrap\";\nimport moment from \"moment\";\nimport axiosInstance, { baseurl } from \"../misc/Axios\";\nimport SubmitButton from \"../Controls/SubmitButton\";\nimport { Link } from \"react-router-dom\";\nimport {\n  getIndirectCategoryWidgets,\n  getCategoryWidgetsTypes,\n  getGenders,\n  getMaritalStatuses,\n  getCategories,\n} from \"../misc/functions\";\nimport { history } from \"../../index\";\nimport NumberField from \"../Controls/NumberField\";\nimport \"./category_widgets.scss\";\nimport Dropzone from \"react-dropzone\";\nimport CategoriesModal from \"../Modals/CategoriesModal\";\nimport Table from \"reactstrap/lib/Table\";\nexport default class CategoryWidget extends Component {\n  state = {\n    showCategoriesModal: false,\n    category_widget: {\n      photo_id: null,\n      description: \"\",\n      link: \"\",\n      products_list: []\n    },\n    editing: false,\n    readOnly:\n      this.props.match.params.id != \"\" && this.props.match.params.id != null,\n    category_widget_uuid: this.props.match.params.id,\n    existing_record:\n      this.props.match.params.id != \"\" && this.props.match.params.id != null,\n  };\n  onChange = (e) => {\n    console.log(e.target.name);\n    this.setState({\n      ...this.state,\n      category_widget: {\n        ...this.state.category_widget,\n        [e.target.name]: e.target.value,\n      },\n    });\n  };\n  onItemChange = (i, e) => {\n    console.log(\"THIS IS INDEX\", i)\n    console.log(\"THIS IS ELEMENT\", e)\n    var products_list = [...this.state.category_widget.products_list]\n    console.log(\"THESE ARE PRODUCTS\", products_list)\n    products_list[i].product = null\n    products_list[i].temp_sku = e.target.value\n  }\n  addProduct = e => {\n    var products_list = this.state.category_widget.products_list\n    products_list.push({temp_sku: \"\", product: {}})\n    this.setState({\n      ...this.state,\n      category_widget: {\n        ...this.state.category_widget,\n        products_list: products_list\n      }\n    })\n  }\n  removeProduct = (i, e) => {\n    var products_list = this.state.category_widget.products_list\n    products_list.splice(i, 1)\n    this.setState({\n      ...this.state,\n      category_widget: {\n        ...this.state.category_widget,\n        products_list: products_list\n      }\n    })\n  }\n  handleChangeSelect = (selectedOption, val) => {\n    var state = {\n      ...this.state,\n      category_widget: {\n        ...this.state.category_widget,\n        [selectedOption]: val.value,\n      },\n      [selectedOption]: val,\n    };\n    this.setState({ ...state });\n  };\n  onDateChanged = (momentdate, attr_name) => {\n    // console.log(\"ClassName is\", momentdate.constructor.name)\n    var new_date = new moment();\n    if (momentdate.constructor.name == new_date.constructor.name) {\n      var new_state = {\n        ...this.state,\n        category_widget: {\n          ...this.state.category_widget,\n          [attr_name]: momentdate,\n        },\n      };\n      this.setState({ ...new_state });\n    } else {\n      console.log(this.state.category_widget[attr_name]);\n      var date = new moment(this.state.category_widget[attr_name]);\n      var new_state = {\n        ...this.state,\n        category_widget: {\n          ...this.state.category_widget,\n          [attr_name]: date,\n        },\n      };\n      this.setState({ ...new_state });\n    }\n  };\n\n  setCategoryWidgets = (state, category_widget) => {\n    var new_state = {\n      ...state,\n      category_widget: category_widget,\n      // category_id: state.categories.find(\n      //   (obj) => obj.value == category_widget.category_id\n      // ),\n    };\n    return new_state;\n  };\n  onValueChange = (e, val) => {\n    console.log(val);\n    this.setState({\n      ...this.state,\n      category_widget: {\n        ...this.state.category_widget,\n        [e]: val.floatValue,\n      },\n    });\n  };\n  handleChangeSelect = (selectedOption, val) => {\n    var state = {\n      ...this.state,\n      category_widget: {\n        ...this.state.category_widget,\n        [selectedOption]: val.value,\n      },\n      [selectedOption]: val,\n    };\n    this.setState({ ...state });\n  };\n  onDrop = (name, acceptedFiles) => {\n    console.log(name);\n    console.log(acceptedFiles);\n    if (this.state.readOnly != true) {\n      acceptedFiles.map((file, i) => {\n        var formData = new FormData();\n        formData.append(\"file\", file);\n        axiosInstance.post(\"/photos\", formData).then((response) => {\n          this.setState({\n            ...this.state,\n            category_widget: {\n              ...this.state.category_widget,\n              photo_id: response.data.photo.id,\n              photo: response.data.photo,\n            },\n          });\n        });\n      });\n    }\n  };\n  componentDidMount = () => {\n    var self = this;\n\n    // Promise.all([getCategories()]).then(([categories]) => {\n      console.log(\"ID\", this.props.match.params.id);\n      if (self.state.existing_record == true) {\n        console.log(\"FECHING EXISTING RECORD\");\n        axiosInstance\n          .get(`/admins/category_widgets/${this.state.category_widget_uuid}`)\n          .then((response) => {\n            var new_state = {\n              ...this.state,\n              existing_record: true,\n              readOnly: true,\n              // categories: categories,\n            };\n            new_state = self.setCategoryWidgets(\n              new_state,\n              response.data.category_widget\n            );\n            self.setState({ ...new_state });\n          });\n      } else {\n        self.setState({\n          ...this.state,\n          // categories: categories,\n        });\n      }\n    // });\n  };\n  toggleCategoriesModal = () => {\n    this.setState({\n        ...this.state,\n        showCategoriesModal: !this.state.showCategoriesModal\n    })\n}\n  onSubmit = (e) => {\n    e.preventDefault();\n    var self = this;\n    var product_ids = this.state.category_widget.products_list.map(item => {\n      if (item.product != null ){\n        return item.product.id\n      }\n    })\n    console.log(\"PRODUCT_IDS\", product_ids)\n    if (self.state.readOnly == true && self.state.existing_record == true) {\n      self.setState({\n        ...self.state,\n        readOnly: false,\n      });\n    } else {\n      var instance;\n      if (self.state.existing_record != true) {\n        instance = axiosInstance.post(\"/admins/category_widgets\", {\n          category_widget: {...this.state.category_widget, product_ids: product_ids},\n        });\n      } else {\n        instance = axiosInstance.put(\n          `/admins/category_widgets/${\n            this.state.category_widget_id || this.state.category_widget.uuid\n          }`,\n          { category_widget: {...this.state.category_widget, product_ids: product_ids} }\n        );\n      }\n      instance.then((response) => {\n        console.log(\"RESPONSE\", response);\n\n        // console.log(\"Setting state\")\n        if (this.state.existing_record == true) {\n          var new_state = this.setCategoryWidgets(\n            this.state,\n            response.data.category_widget\n          );\n          console.log(\"THIS IS NEW STATE\", new_state);\n          this.setState({ ...new_state, readOnly: true });\n        } else {\n          this.props.history.push(\n            `/appearances/category_widgets/${response.data.category_widget.uuid}`\n          );\n          // this.setState({ ...this.state, readOnly: true, existing_record: true, editing: false })\n        }\n      });\n    }\n  }; \n  fetchProduct = (i, e) => {\n    console.log(\"THIS IS VALUE\", e.target.value);\n    var sku = e.target.value\n\n    axiosInstance.get(`/admins/products/get_by_sku?sku=${sku}`).then(response => {\n      console.log(\"THIS IS RESPONSE\", response)\n      if (response.status == 200){\n        var products_list = this.state.category_widget.products_list;\n        products_list[i].product = response.data.product;\n        this.setState({\n          ...this.state,\n          category_widget: {...this.state.category_widget,\n\n          }\n        })\n      }\n    })\n  }\n  selectCategory = (category) => {\n        \n    this.setState({\n      ...this.state,\n      category_widget: {\n        ...this.state.category_widget,\n        category_id: category.id,\n        category: category,\n      },\n    });\n  };\n\n  render() {\n    return (\n      <Col md={12}>\n        <CategoriesModal\n          isOpen={this.state.showCategoriesModal}\n          category_id={this.state.category_widget.category_id}\n          selectCategory={this.selectCategory.bind(this)}\n          toggle={this.toggleCategoriesModal}\n          parentForm={this}\n        />\n        <Card>\n          <CardBody>\n            <CardTitle className=\"col-md-12\">\n              CategoryWidget\n              <ul>\n                <li>\n                  <Link\n                    className=\"btn btn-success btn-sm\"\n                    to=\"/appearances/category_widgets/new\"\n                  >\n                    New CategoryWidget\n                  </Link>\n                </li>\n              </ul>\n            </CardTitle>\n            <CardText className=\"col-md-12\">\n              <Form className=\"row\">\n                <Col md={12}>\n                  <Row>\n                    <Col md={3}>\n                      <Row>\n                        <Dropzone\n                          disabled={this.state.readOnly}\n                          onDrop={\n                            this.readOnly\n                              ? null\n                              : this.onDrop.bind(null, \"photo\")\n                          }\n                        >\n                          {({ getRootProps, getInputProps }) => (\n                            <Col\n                              id=\"photoBox\"\n                              {...getRootProps()}\n                              className={`${\n                                this.state.readOnly ? \"\" : \"dropZone\"\n                              }  col-md-12`}\n                            >\n                              <input {...getInputProps()} />\n\n                              {this.state.category_widget.photo ? (\n                                <img\n                                  src={\n                                    this.state.category_widget.photo.image_url\n                                  }\n                                />\n                              ) : null}\n                            </Col>\n                          )}\n                        </Dropzone>\n                      </Row>\n                    </Col>\n                    <Col md={9}>\n                    <Row>\n                      <FormGroup className=\"col-md-10\">\n                        <Label for=\"exampleEmail\">Category</Label>\n                        <Input\n                          type=\"text\"\n                          name=\"name\"\n                          value={\n                            this.state.category_widget.category\n                              ? this.state.category_widget.category.name\n                              : \"\"\n                          }\n                          placeholder=\"Category Name\"\n                          onChange={this.onChange}\n                          readOnly={true}\n                        />\n                      </FormGroup>\n                      <FormGroup className=\"col-md-2\">\n                        <Label for=\"exampleEmail\">&nbsp;</Label>\n                        <Button\n                          className=\"form-control\"\n                          onClick={this.toggleCategoriesModal}\n                          disabled={this.state.readOnly}\n                        >\n                          Select \n                        </Button>\n                      </FormGroup>\n                      </Row>\n                      <Row>\n                       \n                        <FormGroup className=\"col-md-12\">\n                          <Label for=\"name\">Description</Label>\n                          <Input\n                            type=\"textarea\"\n                            name=\"description\"\n                            value={this.state.category_widget.description}\n                            placeholder=\"Slider Description\"\n                            onChange={this.onChange}\n                            readOnly={this.state.readOnly}\n                          />\n                        </FormGroup>\n                        <FormGroup className=\"col-md-12\">\n                          <Label for=\"name\">Link</Label>\n                          <Input\n                            type=\"text\"\n                            name=\"link\"\n                            value={this.state.category_widget.link}\n                            placeholder=\"Slider Link\"\n                            onChange={this.onChange}\n                            readOnly={this.state.readOnly}\n                          />\n                        </FormGroup>\n                      </Row>\n                    </Col>\n                  </Row>\n\n                  <Row>\n                    <Table striped=\"true\" bordered='true'>\n                          <thead>\n                            <tr>\n                              <th width='25%'>Pruduct SKU</th>\n                              <th width='70%'>Pruduct Name</th>\n                              <th width='5%'></th>\n                              \n                            </tr>\n                          </thead>\n                          <tbody>\n                            {this.state.category_widget.products_list.map((item, i )=> {\n                              return <tr>\n                                <td>\n                                  <Input value={item.product == null ? item.temp_sku : item.product.sku} readOnly={this.state.readOnly} onBlur={this.fetchProduct.bind(this, i)} onChange={this.onItemChange.bind(this, i)}></Input>\n                                </td>\n                                <td>\n                                <Input value={item.product != null ? item.product.name : \"\" } readOnly={true}></Input>\n                                </td>\n                                <td>\n                                <Button color='danger' className='btn-sm' onClick={this.removeProduct} disabled={this.state.readOnly}> X </Button>\n                                </td>\n                              </tr>\n                            })}\n\n                          </tbody>\n                          <tfoot>\n                            <tr>\n                              <td colSpan='3' className='right'>\n                                <Button color='success' className='btn-sm' onClick={this.addProduct} disabled={this.state.readOnly}> Add Product</Button>\n                              </td>\n                            </tr> \n                          </tfoot>\n                    </Table>\n                  </Row>\n                </Col>\n\n                <Col md={12}>\n                  {/* <Row> */}\n                  <SubmitButton\n                    onClick={this.onSubmit}\n                    readOnly={this.state.readOnly}\n                    editing={this.state.editing}\n                    existing_record={this.state.existing_record}\n                  />\n                  {/* </Row> */}\n                </Col>\n              </Form>\n            </CardText>\n          </CardBody>\n        </Card>\n      </Col>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}